<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	  <meta name="author" content="Kiri" />
    <meta name="description" content="Personal website and resume">

    
      <title>Painter By Numbers</title>
    
	
    <!-- Bootstrap -->
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha256-MfvZlkHCEqatNoGiOXveE8FIwMzZg4W85qfrfIFBfYc= sha512-dTfge/zgoMYpP7QbHy4gWMEGsbsdZeCXz7irItjcC3sPUFtf0kuFbDz/ixG7ArTxmDjLXDmezHubeNikyKGVyQ=="
    crossorigin="anonymous">


	<!-- Custom styles for this template -->
    <link rel="stylesheet" type="text/css" href="static/css/main.css" />
	<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,400,200bold,400bold" />
	<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" />
  <link rel="stylesheet" type="text/css" href="static/css/syntax.css" />

    <!-- Google Analytics
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', '', 'auto');
  ga('send', 'pageview');
   -->

</script>
  </head>
  <!-- Main Body-->
  <body>
  <!-- Wrap all page content here -->
  <div id="wrap">
    <!-- Navbar header -->
    <nav class="navbar navbar-default">
  <div class="container">
    <div class="navbar-header">
      <a class="navbar-brand" href="http://small-yellow-duck.github.io/"><i class="fa fa-home fa-lg"></i></a>
    </div>
    <div id="navbar">
      <ul class="nav navbar-nav navbar-right">
        <li><a href="http://small-yellow-duck.github.io/about.html">ABOUT</a></li>
        <li><a href="http://small-yellow-duck.github.io/">PROJECTS</a></li>
      </ul>
    </div>
  </div>
</nav>


    <section id="projects">
<div class="container">
  <h2><strong>Painter By Numbers</strong></h2>
  <div class="panel panel-default">
    <div class="panel-body">

			<h3><strong>Are these two paintings by the same artist?</strong></h3>
			
			<table>
			<tr>			
			<td>
			<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/c6/J._VERMEER_-_El_ge%C3%B3grafo_%28Museo_St%C3%A4del%2C_Fr%C3%A1ncfort_del_Meno%2C_1669%29.jpg/600px-J._VERMEER_-_El_ge%C3%B3grafo_%28Museo_St%C3%A4del%2C_Fr%C3%A1ncfort_del_Meno%2C_1669%29.jpg" height=220 >
			
			</td>				

			<td>
			
			<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/49/Jan_Vermeer_van_Delft_014.jpg/1024px-Jan_Vermeer_van_Delft_014.jpg" height=220 >
			
			</td>
			</tr>
			</table>
	</div>		
	
    <div class="panel-body">
			<font style="line-height:2.0"> 
			<p>The Painter By Numbers competition challenges Kagglers to examine pairs of paintings and predict whether the paintings are by the same artist. The exciting thing about constructing the competition in this way is that instead of learning to label paintings as 'van Gogh' or 'Rembrandt', the algorithm is learning how to distinguish between artists. This means that the algorithm can be used to extrapolate to artists whose work it has never been trained on.</p>			
	
			<p><b>After participating in a dozen or so Kaggle competitions, I was excited to 
			design and run this Kaggle competition myself!</b></p>			
		</div>
		
		
		
		
		<div class="panel-body">
			<div class="title">
				<h3><strong>Competition goals</strong></h3>
			</div>


			<table>
						
			<tr>
			<td  valign=top width=900> <font style="line-height:2.0"> 
			
<b>Building a classification algorithm that can extrapolate to new classes</b>

<p>The pairwise comparison aspect of the competition motivates using a "siamese" neural network. In a siamese neural network, there are two inputs which are processed using the same neural network. The outputs of these two networks are then combined. I prepared some sample code for training a siamese neural network on the MNIST data set:
<a href='https://github.com/small-yellow-duck/kaggle_art/blob/master/mnist_siamese_cnn.py'>mnist_siamese_cnn.py</a>.</p>


<b>Desirable improvements to existing image classification algorithms</b>

I hoped that this challenge would motivate people to make two kinds of improvements to imaging algorithms:

			<ol>
  <li>1. As the images in this data set are all different sizes, I'd like to see a solution which is able to accept input images of different dimensions instead of first resizing all the images so that they have the same width and height.</li>
  <li>2. I'd also like to see some strategies for identifying the "interesting" parts of an image for the algorithm to focus on.</li>
</ol>



<b>Data augmentation</b>

<p>Possible strategies that might be worth trying:</p>

			<ol>
  <li>augment the data set by flipping the images left-to-right and labeling the mirrored images as belonging to a new artist</li>
  <li>augment the data set by making small adjustments to the colour balance in the images</li>
  <li>augment the data set by converting the images to greyscale</li>
  <li> augment the data set by decreasing the resolution of the images</li>
  <li>augment the data set by cropping the images randomly (or developing a scheme to crop the images)</li>
</ol>
    
      
</tr>
</td>		


			</table>	
		
		</div>
		
		
		
		
		<div class="panel-body">	
			<div class="title">
				<h3><strong>Competition considerations</strong></h3>
			</div>


			<table>
						
			<tr>
			<td  valign=top width=900> <font style="line-height:2.0"> 
      

<b>Leakage</b>

<p>I've identified two possible sources of leakage and I'm curious to see how significant they will be as the competition progresses:

<ol>
  <li>Some artists sign their paintings.</li>
    <li>Works by a single artist may have been scanned or photographed at the same resolution.</li>
</ol>    

<p>In addition, I've also wondered if the works in the data set are truly high enough resolution - I certainly anticipate that algorithms would perform better with higher resolution images. But hey, let's see what we can do with the data that we do have!</p>

<b>Including pixel density and resolution information</b>

<p>On the Kaggle forum, user Guilhermo Folego <a href='https://www.kaggle.com/c/painter-by-numbers/forums/t/20547/welcome/121089#post121089'>pointed out</a> that it is desirable to have a data set where the pixel densities / unit physical area are available. Unfortunately, wikiart does not always include the physical dimensions of each painting. I decided that the data set as it stands is still interesting - after all, people can differentiate a Vermeer from a van Gogh without having to know what resolution photographs of the paintings were taken at. </p>

<p>It's also true that creating a data set where all the image are the same resolution would likely allow the algorithm to make better use of information at the scale of brush strokes. The existing data set contains images with a range of resolutions, so the algorithm is not likely going to be able to make use of high-resolution details.</p>

			</td>
			</tr>
			</table>	
		
		
		
		</div>
		
		
		
		
		<div class="panel-body">
			<div class="title">
				<h3><strong>Creating an interesting test data set</strong></h3>
			</div>



			<table>
			<tr>
			<td valign=top align=left width=400><font style="line-height:2.0"> 
						

<p>One of the challenges with setting up the competition was that the test set contained around 20,000 images. Asking competitors to submit predictions for every possible pair of
paintings is kind of unwieldy, both because the time required to generate every prediction
is onerous and because the submission file would run to several GB!</p>

<p>In order to reduce the number of comparisons, I decided to group the paintings according to the artist style metadata available on wikiart. This would mean that the algorithm is generally being asked to do the more challenging task of evaluating pairs of paintings that are more similar: it's a more interesting challenge to see if the algorithm can distinguish Vermeer from Rembrandt than  Hokusai from Rembrandt.</p>

<p>The script that groups the paintings in the plot at right is <a href=' https://github.com/small-yellow-duck/kaggle_art/blob/master/plot_artist_style_overlaps.py'>plot_artist_style_overlaps.py</a>
			
			</td>
			<td valign=top width = 500>
			<img src="https://github.com/small-yellow-duck/kaggle_art/blob/master/artists_clustered_by_style_train_set.png?raw=true" width = 500>
			</td>
			</tr>
			</table>	
		
		</div>
		
		
		
		
		<div class="panel-body">	
			<div class="title">
				<h3><strong>Evaluating the algorithms</strong></h2>
			</div>


			<table>
			<tr>
			<td valign=top align=left width=400><font style="line-height:2.0"> 
						<p><p>The AUC metric was used to evaluate the algorithms. <b>The three top-scoring algorithms all had AUCs greater than 0.9.</b> If I had a surplus of time and ambition, I would build an app to serve pairs of paintings up to human viewers in order to determine if the algorithm is outperforming people.								
			</td>
		
			<td valign=top align=left width=400>
			<figure>
			<img src="https://github.com/small-yellow-duck/kaggle_art/blob/master/vermeer_vs_van_meegeren.png?raw=true" width=500 >
			<figcaption width=400></figcaption></figure>
			</td>			
			</tr>
			</table>
			
			<font style="line-height:2.0">
			<p>One thing I did do to compare the top algorithm to human performance was to slip a famous forger into the test set. Han van Meegeren was a Dutch artist who created several paintings in the style of Dutch masters from the 1700's. van Meegeren was bitter about the lack of commercial success he had with his own art, so he took up creating "new" paintings by old masters and he even sold some forgeries to the Nazis during World War II. I generated a pairwise comparison table for first-place winner <a href='https://www.kaggle.com/nejc92'>orange-nejc</a>'s predictions for van Meegeren and Vermeer paintings in the test set (see at right).</p>

		

			<table>	
			<tr>
			<td >
			
			<img src="https://www.artbible.info/images/vmeegeren_emmaus_grt.jpg" height=220 >
			<p>Dinner at Emmaus (van Meegeren)
			</td>

			<td >
			
			<img src="http://hanvanmeegeren.webs.com/Interieur_met_paar_aan_clavecimbel.jpg" height=220 >
			<p>Interior with couple and clavichord (van Meegeren)
			</td>			
			</tr>
			
			</table>
			
			<table>
			<tr>
			
			
			<td>
			<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/20/Johannes_Vermeer_-_Het_melkmeisje_-_Google_Art_Project.jpg/600px-Johannes_Vermeer_-_Het_melkmeisje_-_Google_Art_Project.jpg" height=220 >
			<p>The Milkmaid (Vermeer)
			</td>				
			
			
			<td>
			<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/c6/J._VERMEER_-_El_ge%C3%B3grafo_%28Museo_St%C3%A4del%2C_Fr%C3%A1ncfort_del_Meno%2C_1669%29.jpg/600px-J._VERMEER_-_El_ge%C3%B3grafo_%28Museo_St%C3%A4del%2C_Fr%C3%A1ncfort_del_Meno%2C_1669%29.jpg" height=220 >
			<p>The Geographer (Vermeer)
			</td>				

			<td >
			
			<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/32/JohannesVermeer-TheAstronomer%281668%29.jpg/1024px-JohannesVermeer-TheAstronomer%281668%29.jpg" height=220 >
			<p>The Astronomer (Vermeer)
			</td>
			

			<td>
			
			<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/49/Jan_Vermeer_van_Delft_014.jpg/1024px-Jan_Vermeer_van_Delft_014.jpg" height=220 >
			<p>Lady at the Virginals with a Gentleman (Vermeer)
			</td>

			</tr>
			
			</table>



			</table>			
		
			
			<table>
			
			<tr>
			<td  valign=top width=900> <font style="line-height:2.0"> 
			<b><ul>Can the algorithm extrapolate?</ul></b>
			<p>One of the goals of this competition was to determine if the algorithm could extrapolate to images by artists who didn't have work in the training set. I've computed the AUC for <a href='https://www.kaggle.com/nejc92'>orange-nejc</a>'s predictions for two cases:
			
			<table>
			<tr>
			<td>AUC for pairs of images by artists with work in the training data set: </td> <td> </td>
			<td>0.94218</td>
			
			<tr>
			<td>AUC for pairs of images by artists with no work in the training data set:   </td> <td> </td>
			<td>0.82509</td>
			</tr>
			</table>
			
			<p>I should do some boot-strapping to generate meaningful error bars, but it looks like <a href='https://www.kaggle.com/nejc92'>orange-nejc</a>'s algorithm is better at interpolating from artists whose work it has seen before than at extrapolating to work by unfamiliar artists.
			
			</td>
			</tr>
			</table>
			
		</div>
		
	</div>



</div>
        

	</div>
  </div>
</div>
</section>



  </div>
  <!-- Footer -->
  <footer>
    <div id="footer">
        <div class="container">
            <p class="text-muted">© Kiri</p>
        </div>
    </div>
</footer>
<div class="footer"></div>


    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <!-- Bootstrap core JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"
    integrity="sha256-Sk3nkD6mLTMOF0EOpNtsIry+s1CsaqQC1rVLTAy+0yc= sha512-K1qjQ+NcF2TYO/eI3M6v8EiNYZfA95pQumfvcVrTHtwQVDG+aHRqLi/ETn2uB+1JqwYqVG3LIvdm9lj6imS/pQ=="
    crossorigin="anonymous"></script>

  </body>
</html>
